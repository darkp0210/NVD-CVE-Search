import requests
from colored import cprint

cve = input("Enter the CVE to search: ")
url = "https://services.nvd.nist.gov/rest/json/cves/2.0?cveId=%s" % cve

headers = {"accept": "application/json"}

try:
  response = requests.get(url, headers=headers)
  cve_details = response.json()

  print("CVE: " + cve_details['vulnerabilities'][0]['cve']['id'])
  print("Vulnerability: " + cve_details['vulnerabilities'][0]['cve']['cisaVulnerabilityName'])
  print("Summary: " + cve_details['vulnerabilities'][0]['cve']['descriptions'][0]['value'])
  print("Source: " + cve_details['vulnerabilities'][0]['cve']['sourceIdentifier'])
  print("Published: " + cve_details['vulnerabilities'][0]['cve']['published'])
  print("Last Modified: " + cve_details['vulnerabilities'][0]['cve']['lastModified'])
  print("Analysis Status: " + cve_details['vulnerabilities'][0]['cve']['vulnStatus'])
  print("Remediation: " + cve_details['vulnerabilities'][0]['cve']['cisaRequiredAction'])
  print("CVSSv3 Vector: " + cve_details['vulnerabilities'][0]['cve']['metrics']['cvssMetricV31'][0]['cvssData']['vectorString'])
  print("Severity: " + str(cve_details['vulnerabilities'][0]['cve']['metrics']['cvssMetricV31'][0]['cvssData']['baseSeverity']))
  print("Base Score: " + str(cve_details['vulnerabilities'][0]['cve']['metrics']['cvssMetricV31'][0]['cvssData']['baseScore']))
  print("Exploitability Score: " + str(cve_details['vulnerabilities'][0]['cve']['metrics']['cvssMetricV31'][0]['exploitabilityScore']))

  def exploit_available():
	  if cve_details['vulnerabilities'][0]['cve']['cisaExploitAdd']:
	      print("Exploit Available: No")
	  else:
		  print("Exploit Available: Yes")

  exploit_available()


except:
  cprint("CVE Not Found in NVD Database", fore_256='light_magenta')

